<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AR.js + Porsche 911</title>

    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>

    <!-- AR.js -->
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.2/aframe/build/aframe-ar.js"></script>
  </head>

  <body style="margin: 0; overflow: hidden;">

    <!-- UI Instructions Overlay -->
    <div id="instructions" style="
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background:rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px 20px;
      font-family: sans-serif;
      border-radius: 10px;
      z-index: 1000;
      text-align: center;">
      Point your camera at the Hiro marker to see the Porsche 911 GT2 RS in AR.
    </div>

    <!-- Rev Button -->
    <button id="revButton" style="
      position: absolute;
      bottom: 20px;
      right: 20px;
      padding: 10px 20px;
      font-size: 16px;
      font-family: sans-serif;
      background-color: #ff4444;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      z-index: 1000;">
      Rev Engine
    </button>

    <!-- A-Frame Scene -->
    <a-scene embedded arjs="sourceType: webcam;">

      <!-- Lighting -->
      <a-entity light="type: directional; color: #ffffff; intensity: 1.2" position="2 2 1"></a-entity>
      <a-entity light="type: directional; color: #ffaa55; intensity: 0.8" position="-2 2 -1"></a-entity>
      <a-entity light="type: ambient; color: #444444"></a-entity>

      <!-- Assets -->
      <a-assets>
        <a-asset-item 
          id="911" 
          src="https://S0INC.github.io/porsche_911_gt2_rs.glb">
        </a-asset-item>

        <audio 
          id="porscheSound" 
          src="info.mp3" 
          preload="auto">
        </audio>

        <audio 
          id="revSound" 
          src="ytmp3freecc-gt2rs-revving-extremely-loud-pops-and-bangs-shorts-youtubemp3freeo_0jY17NtL.mp3" 
          preload="auto">
        </audio>
      </a-assets>

      <!-- Marker -->
      <a-marker preset="hiro" id="hiroMarker">

        <!-- Rotating Wrapper -->
        <a-entity 
          id="rotator" 
          rotation="0 0 0"
          animation="property: rotation; to: 0 360 0; loop: true; dur: 60000; easing: linear;">
          
          <!-- 3D Car Model -->
          <a-entity 
            gltf-model="#911" 
            scale="0.5 0.5 0.5" 
            position="0 0 0">
          </a-entity>
        </a-entity>

        <!-- Label -->
        <a-text 
          value="1975 Porsche 911 Turbo" 
          position="0 1 0" 
          scale="1 1 1" 
          color="white" 
          align="center">
        </a-text>

        <!-- Porsche Sound -->
        <a-sound 
          src="#porscheSound" 
          autoplay="true" 
          loop="true" 
          volume="1" 
          position="0 0.5 0">
        </a-sound>
      </a-marker>

      <!-- AR Camera -->
      <a-entity camera></a-entity>
    </a-scene>

    <!-- JS to Hide Instructions and Handle Button -->
    <script>
      const instructions = document.getElementById("instructions");
      const marker = document.getElementById("hiroMarker");
      const revButton = document.getElementById("revButton");
      const revSound = document.getElementById("revSound");

      marker.addEventListener("markerFound", () => {
        instructions.style.display = "none";
        revButton.style.display = "block";
      });

      marker.addEventListener("markerLost", () => {
        instructions.style.display = "block";
        revButton.style.display = "none";
      });

      revButton.addEventListener("click", () => {
        revSound.currentTime = 0;
        revSound.play();
      });

      // Hide button until marker is found
      revButton.style.display = "none";
    </script>

  </body>
</html>
